# advance

遅延評価と実行: pl.DataFrame.lazy, pl.DataFrame.collect
lazyを使うことで、collectされるまで評価を遅らせることができます。途中結果を変数に格納する場合でも有効です。

以下は少し複雑な例題ですが、冒頭にlazyを使い、最後にcollectで結果を取得します。

P-039: レシート明細データフレーム（df_receipt）から売上日数の多い顧客の上位20件と、売上金額合計の多い顧客の上位20件を抽出し、完全外部結合せよ。ただし、非会員（顧客IDが"Z"から始まるもの）は除外すること。

